# Configuration file for Synapse.
#
# This is a YAML file: see [1] for a quick introduction. Note in particular
# that *indentation is important*: all the elements of a list or dictionary
# should have the same indentation.
#
# [1] https://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html
#
# For more information on how to configure Synapse, including a complete accounting of
# each option, go to docs/usage/configuration/config_documentation.md or
# https://matrix-org.github.io/synapse/latest/usage/configuration/config_documentation.html
server_name: "qdice.wtf"
listeners:
  - port: 8008
    tls: false
    type: http
    x_forwarded: true
    resources:
      - names: [client, federation]
        compress: false
    bind_addresses: ['127.0.0.1']
report_stats: false
# macaroon_secret_key: secret
# form_secret: secret
trusted_key_servers:
  - server_name: "matrix.org"
# recaptcha_public_key: secret
# recaptcha_private_key: secret
enable_registration_captcha: true
enable_registration: true
default_identity_server: https://matrix.org
oidc_providers:
  - idp_id: github
    idp_name: Github
    idp_brand: "github" # optional: styling hint for clients
    discover: false
    issuer: "https://github.com/"
    # client_id: secret
    # client_secret: secret
    authorization_endpoint: "https://github.com/login/oauth/authorize"
    token_endpoint: "https://github.com/login/oauth/access_token"
    userinfo_endpoint: "https://api.github.com/user"
    scopes: ["read:user"]
    user_mapping_provider:
      config:
        subject_claim: "id"
        localpart_template: "{{ user.login }}"
        display_name_template: "{{ user.name }}"
  # - idp_id: google
    # idp_name: Google
    # idp_brand: "google" # optional: styling hint for clients
    # issuer: "https://accounts.google.com/"
    # # client_id: secret
    # # client_secret: secret
    # scopes: ["openid", "profile", "email"] # email is optional, read below
    # user_mapping_provider:
      # config:
        # localpart_template: "{{ user.given_name|lower }}"
        # display_name_template: "{{ user.name }}"
        # email_template: "{{ user.email }}" # needs "email" in scopes above
password_config:
  enabled: true
  # pepper: secret
  policy:
    enabled: true
    minimum_length: 1
    require_digit: false
    require_symbol: false
    require_lowercase: false
    require_uppercase: false
enable_3pid_lookup: false
email:
  app_name: "matrix"
  notif_from: "noreply@qdice.wtf"
  enable_notifs: true
  smtp_host: "127.0.0.1"
  smtp_port: 25
  # smtp_user: ""
  # smtp_pass: ""
  force_tls: false
  require_transport_security: false
  notif_for_new_users: false
  client_base_url: "https://qdice.wtf"
url_preview_enabled: true
url_preview_ip_range_blacklist:
  - "127.0.0.0/8"
  - "68.183.1.170/16"
  - "fc00::/7"
media_retention:
  local_media_lifetime: 30d
  remote_media_lifetime: 14d
track_appservice_user_ips: true
experimental_features:
  msc2409_to_device_messages_enabled: true
  msc3202_device_masquerading: true  # This might help with read markers
  msc3391_phantom_receipt_enabled: true # This one specifically helps with read marker permissions
allow_application_service_read_markers: true
enable_admin_api: true

